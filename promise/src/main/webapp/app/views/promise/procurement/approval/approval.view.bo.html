<div class="app-view-header"><span translate="promise.procurement.master.bookingOrder.approvalPR"></span>
    <!-- <small ng-bind="app.name + ' - ' + app.description"></small> -->
</div>

<!--START CONTROLLER-->
<div class="panel panel-primary" ng-controller="ApprovalViewBOController as vm">
    
	<div class="panel panel-primary" > <!-- ng-show="showFormCreateSo" id="anchor1" -->
		<div class="panel-body">
			<div class="row">
			
				<h4 ng-class="'bg-' + app.theme.name" class="panel-heading">
					 BO - {{bookingOrder.boNumber}}
				</h4>
				<!-- KAI - 20210204 - #20867  -->
			<div class="form-group m-b-sm" ng-repeat="shipTo in vm.shipping track by $index" ng-init="indexShipTo = $index">
			
				<div class="col-md-12">
				 <strong style="font-size: 20px;">Shipping  {{ indexShipTo+1 }}</strong>
					<div align="center" ng-if="loading == true"><strong><em>Loading...</em><img src="app/img/loading.gif" width="20px"></strong></div>
			        	<form method="post" action="#" novalidate="" class="form-horizontal">		                
			            	<fieldset>
								<br/>
								<h5 class="form-group" align="left">
					            	<label class="col-sm-3 control-label">Ship To </label>
								</h5>
			                	<!-- <hr/> -->
			                	<!-- untuk KAI 2-11-2020 -->
			                	<!-- <div class="form-group">
								<label class="col-sm-4 control-label">
									<span translate="promise.procurement.master.bookingOrder.view.puspelCode"></span></label>
										<div class="col-sm-6">
											<input disabled type="text" class="form-control"
										ng-model="bookingOrder.puspelCode">
										</div>
								</div> -->
								
			                	<div class="form-group">
					            	<label class="col-sm-4 control-label"><span translate="promise.procurement.master.bookingOrder.view.nama"></span></label>
					                <div class="col-sm-4">
					                	<input type="text" class="form-control shadow-z1 input-sm" ng-model="shipTo.fullName" disabled
												><strong style="color: red">{{errormessageFieldNmShip}}</strong>
										<br/>
					        		</div>
								</div>
			                	<div class="form-group">
					            	<label class="col-sm-4 control-label"><strong><span translate="promise.procurement.master.bookingOrder.view.address"></span></strong>
					                </label>
					                <div class="col-sm-4">
					               			<textarea disabled class="form-control shadow-z1 input-sm"  rows="5" cols="5">{{shipTo.addressLabel}}, {{shipTo.streetAddress}}, {{shipTo.city}}, {{shipTo.country}}</textarea>	<strong style="color: red">{{errormessageFieldALShip}}</strong>						
					        		</div>
								</div>
			                	<div class="form-group">
					            	<label class="col-sm-4 control-label"><span translate="promise.procurement.master.bookingOrder.view.telephone"></span></label>
									<div class="col-sm-4">
										<input disabled  promise-numbers-only-copy type="text" class="form-control shadow-z1 input-sm" ng-model="shipTo.telephone" ><strong style="color: red">{{errormessageFieldtlpShip}}</strong>
					        		</div>
	
								</div>
								 <div class="form-group">
					            	<label class="col-sm-4 control-label">BO Number</label>
									<div class="col-sm-4">
										<input disabled type="text" class="form-control shadow-z1 input-sm" ng-model="bookingOrder.boNumber">
												<strong style="color: red">{{errorboNumber}}</strong></span>
									</div>
	
								</div> 
								<div class="form-group">
									<label class="col-sm-4 control-label">SLA</label>
									<div class="col-sm-4">
										<input disabled type="text"
											class="form-control shadow-z1 input-sm"
											ng-model="vm.slaDeliveryTimeList[indexShipTo]"> <strong
											style="color: red">{{errorboNumber}}</strong></span>
									</div>
									<label><strong><span translate="promise.procurement.master.bookingOrder.view.day"></span></strong></label>
								</div>
								<div class="form-group">
									<label class="col-sm-4 control-label"><span translate="promise.procurement.master.bookingOrder.view.vendor_name"></span></label>
									<div class="col-sm-4">
										<input type="text" class="form-control shadow-z1 input-sm" height="200px" ng-model="vm.purchaseRequestItemList[0].vendorname" disabled="disabled">
									</div>
								</div>
			                    </fieldset>
			                    <hr style="position:relative;margin-top:0px;">
							</form>
			            </div>		
							<div class="form-group">
								<div class="col-sm-2"></div>
								<div class="col-sm-12" style="margin-bottom: 20px;">
									<div class="table-responsive">
										<hr style="position:relative;margin-bottom:0px;">
                                       <table datatables class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%" >
                                          <thead>
                                              <tr style="font-weight: bold">
			                                        <th scope="col"style="width: 2%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.no"></span></th>
													<th scope="col"style="width: 15%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.item_code"></span></th>
													<th scope="col"style="width: 20%; text-align: center"><span>GL Account</span></th>
													<th scope="col"style="width: 20%; text-align: center"><span><span translate="promise.procurement.master.bookingOrder.list.item_decription"></span></span></th>
													<th scope="col"style="width: 15%; text-align: center"><span><span translate="promise.procurement.master.bookingOrder.list.quantity"></span></span></th>
													<th scope="col"style="width: 10%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.discount"></span></th>
													<th scope="col"style="width: 10%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.ppn"></span></th>
													<th scope="col"style="width: 10%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.price"></span></th>
													<th scope="col"style="width: 10%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.price"></span>(Nett)</th>
													<th scope="col"style="width: 10%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.price_with_discount"></span></th>
													<th scope="col"style="width: 10%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.total"></span></th>
													<th scope="col"style="width: 10%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.ongkos_kirim"></span></th>
													<th scope="col"style="width: 15%; text-align: center"><span translate="promise.procurement.master.bookingOrder.list.sub_total"></span></th>
                                               </tr>
                                           </thead>
                                           <tbody>
												<tr ng-repeat="prItem in vm.prItemListNew[indexShipTo]">
											  
												  	<td style="text-align: center">{{ $index+1 }}</td>
													<td style="text-align: center">{{ prItem.catalog.item.kode }}</td>
													<td style="text-align:center">{{ prItem.gLAccountSap.code }}</td>      
													<td style="text-align: center">{{ prItem.catalog.catalogContractDetail.itemDesc}}</td>
													<td style="text-align: center">{{ prItem.quantity }} {{ prItem.catalog.satuan.nama }}</td>
													<td style="text-align: center">{{ prItem.discount }} %</td>
													<td style="text-align: center">{{ prItem.catalog.catalogKontrak.isPpn==1?10:0 }}</td>
													<td style="text-align: right">{{ prItem.normalPrice | currency:'' }}</td>
													<td style="text-align: center">{{ vm.priceIncludePPN[indexShipTo][$index] | currency:''}}</td>
													<td style="text-align: right">{{ prItem.price | currency:'' }}</td>
													<td style="text-align: right">{{ prItem.total | currency:'' }}</td>
													<td style="text-align: right">{{ prItem.ongkosKirim | currency:'' }}</td>
	                            					<!-- <td style="text-align:center">
	                            						<input type="checkbox" ng-disabled="true" ng-model="vm.asuransi[$index]"> {{ prItem.asuransi }} %
	                            					</td> -->
	                            					<td style="text-align:right" >
	                            						<div>
	                            							{{ (prItem.total + prItem.ongkosKirim + ((prItem.asuransi/100)*prItem.total)) | currency:'' }} 
	                            						</div>
	                            					</td>
                            					</tr>
                                           </tbody>
                                           <tfoot>
                                           		<tr>
				                                    <!-- KAI - 20210204 - #20867  -->
				                                    <th scope="col"colspan="10" style="text-align: right;"><span translate="promise.procurement.master.bookingOrder.list.totalCaps"></span></th>
				                                    <!-- <th scope="col"style="text-align: right">{{ grandTotal | currency:'' }} IDR	</th> -->
				                                    <th scope="col"style="text-align: right;">{{ vm.totalHargaShipTo[indexShipTo] | currency:'' }}</th>
				                                    <th scope="col"style="text-align: right;">{{ vm.totalOngkirShipTo[indexShipTo] | currency:'' }}</th>
				                                    <th scope="col"style="text-align: right;">{{ vm.subTotalShipTo[indexShipTo] | currency:'' }}</th>
				                                </tr>
                                           </tfoot>
                                       </table>
                                    </div>
								</div>
							</div>
						</div>
				        <div class="col-sm-12">
				            <table datatables class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%" style="position:relative;margin-top:-30px;">
				                <thead>
				                    <tr style="font-weight: bold;">
				                        <th scope="col"colspan="12" style="width: 100%; text-align: center;"><strong>GRAND TOTAL</strong></th>
				                    </tr>
				                </thead>
				                <tbody></tbody>
				                <tfoot>
				                   <tr>
                                        <th scope="col"colspan="7" style="text-align: right"><span>TOTAL (Rp)</span></th>
                                        <th scope="col"style="text-align: center"></th>
                                         <!-- <th scope="col"style="text-align: right">{{ grandTotal | currency:'' }} IDR	</th> -->
		   								<th scope="col"style="text-align: right">{{ vm.purchaseRequestItemList[0].purchaserequest.totalHarga | currency:'' }}	</th>
			
                                     </tr>
                                 		<tr>
                                        <th scope="col"colspan="7" style="text-align: right"><span>TOTAL ONGKOS KIRIM (Rp)</span></th>
                                        <th scope="col"style="text-align: center"></th>
                                        <!-- <th scope="col"style="text-align: right">{{ grandTotal | currency:'' }} IDR	</th> -->
		   								<th scope="col"style="text-align: right">{{ vm.purchaseRequestItemList[0].purchaserequest.totalHargaOngkir | currency:'' }}	</th>
			
                                     </tr>
                                     <tr>
                                        <th scope="col"colspan="7" style="text-align: right"><span>GRAND TOTAL (Rp)</span></th>
                                        <th scope="col"style="text-align: center"></th>
                                        <!-- <th scope="col"style="text-align: right">{{ grandTotal | currency:'' }} IDR	</th> -->
		   								<th scope="col"style="text-align: right">{{vm.purchaseRequestItemList[0].purchaserequest.totalHarga+vm.purchaseRequestItemList[0].purchaserequest.totalHargaOngkir+vm.purchaseRequestItemList[0].purchaserequest.totalHargaAsuransi | currency:'' }}</th>
			
                                     </tr>
				                </tfoot>
				            </table>
				        </div>

				
					<div class="form-group">
						<div class="bs-wizard no-margin">

							<div class="col-md-12">
								<div ng-repeat="flow in form.levelList | orderBy: flow.sequence" class="bs-wizard-step {{(flow.status==3?'complete':'')}}">
									<div ng-if="flow.approvalLevel.approval.approvalType.id == 1" class="text-center bs-wizard-stepnum" ng-bind="flow.approvalLevel.group.nama">123</div>
				                    <div ng-if="flow.approvalLevel.approval.approvalType.id == 2" class="text-center bs-wizard-stepnum" ng-bind="flow.approvalLevel.user.namaPengguna">321</div>
				                    <div ng-if="flow.approvalLevel.approval.approvalType.id == 3" class="text-center bs-wizard-stepnum" ng-bind="flow.approvalLevel.role.nama">11</div>
                                    <!-- jika new approval-->
                                    <div ng-if="flow.approvalLevel==null" class="text-center bs-wizard-stepnum" ng-bind="flow.user.namaPengguna"></div>

									<div class="progress">
										<div class="progress-bar"></div>
									</div>
									<a href="#" class="bs-wizard-dot"></a>
									<div class="text-center">{{($index+1)}}</div>
								</div>

							</div>

						</div>
					</div>
					<div class="form-group">
					<div class="col-sm-12">
						<div class="app-view-header">
							&nbsp;&nbsp;&nbsp;Approval <strong>Confirmation</strong> Vendor
						</div>
					</div>
					<div class="col-sm-12">
						<div class="table-responsive">
							<hr style="position:relative;margin-bottom:0px;">
							<table datatables
								class="table table-striped table-bordered dt-responsive nowrap"
								cellspacing="0" width="100%">
								<thead>
									<tr style="font-weight: bold">
										<th scope="col"style="width: 2%; text-align: center"><span>No</span></th>
										<th scope="col"style="width: 15%; text-align: center"><span>Approver</span></th>
										<th scope="col"style="width: 20%; text-align: center"><span>Approval
												Status</span></th>
										<th scope="col"style="width: 20%; text-align: center"><span>Note</span></th>
										<th scope="col"style="width: 10%; text-align: center"><span>Approval
												Date</span></th>
									</tr>
									<tr ng-hide="vm.approvalConfirmationVendorList.length">
										<td style="text-align: center" colspan="5">No Data
											Available In Table</td>
									</tr>
								</thead>
								<tbody>
									<tr
										ng-repeat="approvalProcessVendor in vm.approvalConfirmationVendorList">
										<td class="text-center">{{ $index+1 }}</td>
										<td ng-bind="approvalProcessVendor.user.namaPengguna"></td>
										<td><span ng-if=approvalProcessVendor.status==2>Rejected
										</span> <span ng-if=approvalProcessVendor.status==3>Approved</span></td>
										<td>
										    <span ng-if=approvalProcessVendor.keterangan==null>-</span>
											<span ng-bind="approvalProcessVendor.keterangan"></span>
										</td>
										<td>{{ approvalProcessVendor.updated |
											date:"dd-MM-yyyy"}}</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>			
				<br /> <br />
				<div class="form-group">
					<div class="col-sm-12">
						<div class="app-view-header">
							&nbsp;&nbsp;&nbsp;Approval <strong>Internal</strong> Log
						</div>
					</div>
					<div class="col-sm-12">
						<div class="table-responsive">
							<hr style="position:relative;margin-bottom:0px;">
							<table datatables
								class="table table-striped table-bordered dt-responsive nowrap"
								cellspacing="0" width="100%">
								<thead>
									<tr style="font-weight: bold">
										<th scope="col"style="width: 2%; text-align: center"><span>No</span></th>
										<th scope="col"style="width: 15%; text-align: center"><span>Approver</span></th>
										<th scope="col"style="width: 20%; text-align: center"><span>Approval
												Status</span></th>
										<th scope="col"style="width: 20%; text-align: center"><span>Note</span></th>
										<th scope="col"style="width: 10%; text-align: center"><span>Approval
												Date</span></th>
									</tr>
									<tr ng-hide="vm.approvalInternalLogList.length">
										<td style="text-align: center" colspan="5">No Data
											Available In Table</td>
									</tr>
								</thead>
								<tbody>
									<tr
										ng-repeat="approvalInternalLogUserList in vm.approvalInternalLogList">
										<td class="text-center">{{ $index+1 }}</td>
										<td ng-bind="approvalInternalLogUserList.user.namaPengguna"></td>
										<td><span ng-if=approvalInternalLogUserList.status==2>Rejected
										</span> <span ng-if=approvalInternalLogUserList.status==3>Approved</span>
										</td>
										<td><span ng-if=approvalInternalLogUserList.keterangan==null>-</span>
											<span ng-bind="approvalInternalLogUserList.keterangan"></span></td>
										<td>{{ approvalInternalLogUserList.updated |
											date:"dd-MM-yyyy"}}</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<div class="form-group">
					<div class="text-center">
						<h3>Approve this Request</h3>
						<span>This Request Needs Your Approval</span>
					</div>
				</div>
				<div class="form-group">
					<div class="form-group text-center">
						<a class="btn btn-success" ng-click="btnSimpan(1)">Approve</a>
						<!-- <a class="btn btn-warning" ng-click="btnSimpan(4)">Hold</a> -->
						<a class="btn btn-danger" ng-click="btnSimpan(2)">Reject</a>
					</div>
					<div class="form-group">
						<label class="col-lg-4 control-label text-right required">Note</label>
						<div class="col-lg-4">
							<textarea  class="form-control shadow-z1 input-sm"  ng-model="vm.note" style="margin: 0px; width: 350px; height: 125px;"></textarea>
							<strong style="color:red">{{errorNoteMessage}}</strong>
						</div>
					</div>
				</div>
				<br/>
			</div>
		</div>
	</div>
</div>
    
<!--END CONTROLLER-->